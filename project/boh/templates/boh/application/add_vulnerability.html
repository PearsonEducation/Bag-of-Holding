{% extends "boh/application/base_applications.html" %}

{% load i18n %}
{% load staticfiles %}
{% block title %}{{ application.name }} | {% trans 'Vulnerabilities' %} | {% trans 'Add Vulnerability' %}{% endblock %}
{% block css %}
  <link href="{% static 'boh/css/datepicker.min.css' %}" rel="stylesheet">
{% endblock css %}

{% block application_content %}
<div class="row">
  <div class="col-md-8">
    <form method="post" action="{% url 'boh:application.vulnerabilities.add' application.id %}" enctype="multipart/form-data">
      {% csrf_token %}
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">{% trans 'Create Vulnerability' %}</h3>
        </div>
        <div class="panel-body">
          {% include "boh/snippets/form/_general.html" with control=form.affected_version %}
          {% include "boh/snippets/form/_general.html" with control=form.name %}
          {% include "boh/snippets/form/_general.html" with control=form.severity %}
          {% include "boh/snippets/form/_markdown.html" with control=form.description %}
          {% include "boh/snippets/form/_markdown.html" with control=form.environment %}
          {% include "boh/snippets/form/_markdown.html" with control=form.pre_conditions %}
          {% include "boh/snippets/form/_markdown.html" with control=form.attack_vector %}
          {% include "boh/snippets/form/_markdown.html" with control=form.reproduction_steps %}
          {% include "boh/snippets/form/_markdown.html" with control=form.solution %}
          {% include "boh/snippets/form/_general.html" with control=form.reporter %}
          {% include "boh/snippets/form/_general.html" with control=form.detection_method %}
          {% include "boh/snippets/form/_general.html" with control=form.vulnerability_classes%}
          <div class="input-daterange">
            {% include "boh/snippets/form/_general.html" with control=form.deadline %}</div>
          {% include "boh/snippets/form/_general.html" with control=form.tags %}
        </div>
        <div class="panel-footer">
          <button class="btn btn-primary" type="submit">{% trans 'Create Vulnerability' %}</button>
          <a href="{% url 'boh:vulnerability.list' %}" class="btn btn-default" role="button">{% trans 'Cancel' %}</a>
        </div>
      </div>
    </form>
  </div>
</div>
{% endblock application_content %}
{% block js %}
  <script src="{% static 'boh/js/datepicker.min.js' %}"></script>
  <script>
    $('.input-daterange').datepicker({
      format: "yyyy-mm-dd",
      todayBtn: "linked",
      todayHighlight: true
    });
  </script>
{% endblock js %}
