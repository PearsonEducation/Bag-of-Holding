{% extends "boh/vulnerability/base_vulnerability.html" %}

{% load i18n %}
{% load boh_tags %}
{% load humanize %}
{% load markdown_render %}

{% block title %}{{ vulnerability.name }}{% endblock %}

{% block vulnerability_content %}
  <div class="row">
    <div class="col-md-12 clearfix">
      <div class="pull-right">
        <nav>
          <span class="text-muted"><b>{{ attachments.start_index }}</b> - <b>{{ attachments.end_index }}</b> of <b>{{ attachments.paginator.count }}</b></span>
          <div class="btn-group" role="group" aria-label="...">
            <a class="btn btn-default{% if not attachments.has_previous %} disabled{% endif %}" href="{% if attachments.has_previous %}?page={{ attachments.previous_page_number }}{% endif %}" role="button"><span class="fa fa-chevron-left"></span></a>
            <a class="btn btn-default{% if not attachments.has_next %} disabled{% endif %}" href="{% if attachments.has_next %}?page={{ attachments.next_page_number }}{% endif %}" role="button"><span class="fa fa-chevron-right"></span></a>
          </div>
        </nav>
      </div>
      <a href="{% url 'boh:vulnerability.attachments.add' vulnerability_id=vulnerability.id %}" class="btn btn-success" role="button"><i class="fa fa-plus"></i> {% trans 'Attach a file' %}</a>
    </div>
  </div>

  <hr />

  <div class="row">
    <div class="col-md-12">
      <div class="table-responsive">
        <table class="table table-striped">
          <thead>
          <tr>
            <th class="col-md-4">{% trans 'File name' %}</th>
            <th class="col-md-7">{% trans 'Description' %}</th>
            <th class="col-md-1">{% trans 'Delete' %}</th>
          </tr>
          </thead>
          <tbody>
          {% for item in attachments %}
            <tr>
              <td><a href="{{ item.attachment.url }}">{{ item.file_name }} </a></td>
              <td> {{ item.description|markdown_render }}</td>
              <td><a href="{% url 'boh:vulnerability.attachments.delete' attachment_id=item.id vulnerability_id=vulnerability.id %}" class="btn btn-danger" role="button"><i class="fa fa-remove"></i> {% trans 'Delete' %}</a></td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
{% endblock vulnerability_content %}
