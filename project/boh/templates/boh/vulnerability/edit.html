{% extends "boh/base.html" %}

{% load i18n %}

{% block title %}{% trans 'Update Vulnerabilty' %}{% endblock %}

{% block content %}
  <div class="row">
    <div class="col-md-12">
      {% if reopen %}
      <form method="post" action="{% url 'boh:vulnerability.reopen' vulnerability.id %}" enctype="multipart/form-data">
      {% else %}
      <form method="post" action="{% url 'boh:vulnerability.edit' vulnerability.id %}" enctype="multipart/form-data">
      {% endif %}
        {% csrf_token %}
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">{% trans 'Edit Vulnerability' %}</h3>
          </div>
          <div class="panel-body">
            {% include "boh/snippets/form/_general.html" with control=form.affected_app %}
            {% include "boh/snippets/form/_general.html" with control=form.affected_version %}
            {% include "boh/snippets/form/_general.html" with control=form.name %}
            {% if not reopen %}
            {% include "boh/snippets/form/_general.html" with control=form.status %}
            {% endif %}
            {% include "boh/snippets/form/_general.html" with control=form.severity %}
            {% include "boh/snippets/form/_markdown.html" with control=form.description %}
            {% include "boh/snippets/form/_markdown.html" with control=form.environment %}
            {% include "boh/snippets/form/_markdown.html" with control=form.pre_conditions %}
            {% include "boh/snippets/form/_markdown.html" with control=form.attack_vector %}
            {% include "boh/snippets/form/_markdown.html" with control=form.reproduction_steps %}
            {% include "boh/snippets/form/_markdown.html" with control=form.solution %}
            {% include "boh/snippets/form/_general.html" with control=form.reporter %}
            {% include "boh/snippets/form/_general.html" with control=form.detection_method %}
            {% include "boh/snippets/form/_general.html" with control=form.vulnerability_classes %}
            {% include "boh/snippets/form/_general.html" with control=form.deadline %}
            {% include "boh/snippets/form/_general.html" with control=form.tags %}
          </div>
          <div class="panel-footer">
            <button class="btn btn-primary" type="submit">{% trans 'Update Vulnerability' %}</button>
            <a href="{% url 'boh:vulnerability.list' %}" class="btn btn-default" role="button">{% trans 'Cancel' %}</a>
          </div>
        </div>
      </form>
    </div>
  </div>
{% endblock content %}
